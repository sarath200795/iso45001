<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISO 45001 | Management Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Dashboard = () => {
            // 1. STATE FOR METRICS
            const [stats, setStats] = useState({
                totalDocs: 0,
                draftDocs: 0,
                openIncidents: 0,
                auditsDue: 0,
                improvements: 0
            });

            const [context, setContext] = useState({ org: '', site: '', user: '' });

            // 2. LOAD DATA FROM LOCAL STORAGE
            useEffect(() => {
                // Load Context
                setContext({
                    org: localStorage.getItem('orgId') || 'ORG-001',
                    site: localStorage.getItem('siteId') || 'SITE-HQ',
                    user: 'Admin User' // In a real app, this comes from session
                });

                // Load Document Stats (Index 4/5)
                const docs = JSON.parse(localStorage.getItem('isoDocuments')) || [];
                
                // Load Performance Stats (Index 6)
                const incidents = JSON.parse(localStorage.getItem('isoIncidents')) || [];
                const audits = JSON.parse(localStorage.getItem('isoAudits')) || [];
                const improvs = JSON.parse(localStorage.getItem('isoImprovements')) || [];

                setStats({
                    totalDocs: docs.length,
                    draftDocs: docs.filter(d => d.status === 'Draft').length,
                    openIncidents: incidents.filter(i => i.status === 'Open').length,
                    auditsDue: audits.filter(a => a.status === 'Scheduled').length,
                    improvements: improvs.filter(i => i.status === 'In Progress').length
                });
            }, []);

            // 3. NAVIGATION COMPONENT
            const NavCard = ({ title, icon, link, desc, color }) => (
                <a href={link} className={`block bg-white p-6 rounded-2xl border border-slate-100 shadow-sm transition-all duration-300 card-hover group`}>
                    <div className={`w-12 h-12 rounded-xl flex items-center justify-center mb-4 ${color} text-white text-xl shadow-md group-hover:scale-110 transition-transform`}>
                        <i className={`fas ${icon}`}></i>
                    </div>
                    <h3 className="text-lg font-bold text-slate-800 mb-1 group-hover:text-blue-600 transition-colors">{title}</h3>
                    <p className="text-xs text-slate-500 leading-relaxed">{desc}</p>
                </a>
            );

            const StatCard = ({ label, value, icon, color, sub }) => (
                <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm flex items-center justify-between">
                    <div>
                        <p className="text-xs font-bold text-slate-400 uppercase tracking-wider">{label}</p>
                        <h4 className="text-3xl font-black text-slate-800 mt-1">{value}</h4>
                        {sub && <p className="text-[10px] text-slate-400 mt-1">{sub}</p>}
                    </div>
                    <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl ${color}`}>
                        <i className={`fas ${icon}`}></i>
                    </div>
                </div>
            );

            return (
                <div className="flex flex-col min-h-screen">
                    
                    {/* --- HEADER --- */}
                    <header className="bg-slate-900 text-white pt-6 pb-24 px-8 shadow-lg">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center font-black italic">ISO</div>
                                <div>
                                    <h1 className="text-xl font-bold tracking-tight">OH&S Management System</h1>
                                    <p className="text-xs text-slate-400 font-mono">{context.org} / {context.site}</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-6">
                                <div className="text-right hidden md:block">
                                    <div className="text-sm font-bold text-slate-200">{new Date().toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                                    <div className="text-xs text-blue-400">System Status: <span className="text-emerald-400">‚óè Online</span></div>
                                </div>
                                <div className="w-10 h-10 bg-slate-700 rounded-full flex items-center justify-center border-2 border-slate-600 text-slate-300">
                                    <i className="fas fa-user"></i>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* --- MAIN CONTENT (Overlapping Header) --- */}
                    <main className="flex-1 max-w-7xl mx-auto px-6 w-full -mt-16 pb-12 fade-in">
                        
                        {/* 1. KEY METRICS ROW */}
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
                            <StatCard 
                                label="Total Documents" 
                                value={stats.totalDocs} 
                                sub={`${stats.draftDocs} Drafts Pending`}
                                icon="fa-file-alt" 
                                color="bg-blue-50 text-blue-600" 
                            />
                            <StatCard 
                                label="Open Incidents" 
                                value={stats.openIncidents} 
                                icon="fa-exclamation-triangle" 
                                color="bg-red-50 text-red-600" 
                            />
                            <StatCard 
                                label="Audits Due" 
                                value={stats.auditsDue} 
                                icon="fa-clipboard-check" 
                                color="bg-orange-50 text-orange-600" 
                            />
                            <StatCard 
                                label="Active Improvements" 
                                value={stats.improvements} 
                                icon="fa-chart-line" 
                                color="bg-emerald-50 text-emerald-600" 
                            />
                        </div>

                        {/* 2. MODULE NAVIGATION GRID */}
                        <div className="mb-4 flex items-center justify-between">
                            <h2 className="text-xl font-black text-slate-800 italic">System Modules</h2>
                            <span className="text-xs bg-slate-200 px-3 py-1 rounded-full text-slate-600 font-bold">PDCA Cycle</span>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                            
                            {/* PLAN */}
                            <NavCard 
                                title="Context & Leadership" 
                                desc="Clause 4 & 5: Org Context, Policy, Roles (RASCI) and Worker Consultation."
                                icon="fa-users-cog" 
                                color="bg-indigo-600"
                                link="clause5.html" 
                            />
                             <NavCard 
                                title="Document Control" 
                                desc="Create, Approve, and Manage your ISO Documentation Repository."
                                icon="fa-folder-open" 
                                color="bg-blue-600"
                                link="index5.html" 
                            />

                            {/* DO */}
                            <NavCard 
                                title="Create New Document" 
                                desc="Direct link to the Document Authoring Wizard (Clause 7.5)."
                                icon="fa-plus-circle" 
                                color="bg-sky-500"
                                link="index4.html" 
                            />

                            {/* CHECK */}
                            <NavCard 
                                title="Performance & Audit" 
                                desc="Clause 9: Internal Audits, Monitoring, and Compliance Checks."
                                icon="fa-tasks" 
                                color="bg-orange-500"
                                link="index6.html" 
                            />

                             {/* ACT */}
                            <NavCard 
                                title="Incidents & Improvement" 
                                desc="Clause 10: Incident Logs, Non-conformities, and Corrective Actions."
                                icon="fa-first-aid" 
                                color="bg-red-600"
                                link="index6.html" 
                            />

                            {/* SETTINGS */}
                             <NavCard 
                                title="System Settings" 
                                desc="Configure Site parameters, Logo, and User Access controls."
                                icon="fa-cogs" 
                                color="bg-slate-600"
                                link="#" 
                            />
                        </div>

                        {/* 3. QUICK ACTIONS BAR */}
                        <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-8 text-white flex flex-col md:flex-row items-center justify-between shadow-xl">
                            <div className="mb-4 md:mb-0">
                                <h3 className="text-2xl font-bold mb-2">Need to report a Hazard?</h3>
                                <p className="text-slate-400 text-sm max-w-md">Quickly log a Near Miss or Hazard observation to ensure the safety of your team immediately.</p>
                            </div>
                            <div className="flex gap-4">
                                <a href="index6.html" className="bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-xl font-bold transition shadow-lg flex items-center gap-2">
                                    <i className="fas fa-bullhorn"></i> Report Incident
                                </a>
                                <a href="index4.html" className="bg-white/10 hover:bg-white/20 text-white px-6 py-3 rounded-xl font-bold transition flex items-center gap-2 backdrop-blur-sm">
                                    <i className="fas fa-file-medical"></i> New Procedure
                                </a>
                            </div>
                        </div>

                    </main>

                    {/* FOOTER */}
                    <footer className="bg-slate-100 py-8 border-t border-slate-200 mt-auto">
                        <div className="max-w-7xl mx-auto px-6 text-center text-xs text-slate-400">
                            <p>&copy; 2024 ISO 45001 Management System. Internal Use Only.</p>
                            <p className="mt-1">Logged in as: {context.user}</p>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
