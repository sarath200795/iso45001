<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultation & Participation</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: { colors: { 'slate-850': '#1e293b', 'slate-950': '#020617' } }
            }
        }
    </script>
    <style>
        body { background-color: #0f172a; color: #f8fafc; font-family: sans-serif; }
        .glass-panel { background: rgba(30, 41, 59, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); transition: all 0.2s; }
        .glass-panel:hover { border-color: rgba(59, 130, 246, 0.4); transform: translateY(-2px); cursor: pointer; }
        input, select, textarea { background: #0f172a; border: 1px solid #334155; color: white; padding: 8px; border-radius: 6px; outline: none; width: 100%; transition: border-color 0.2s; }
        input:focus, select:focus, textarea:focus { border-color: #3b82f6; }
        
        /* Status Colors */
        .status-Open { color: #f87171; background: rgba(248, 113, 113, 0.1); }
        .status-InProgress { color: #facc15; background: rgba(250, 204, 21, 0.1); }
        .status-Closed { color: #34d399; background: rgba(52, 211, 153, 0.1); }

        /* PRINT STYLES FOR PDF GENERATION */
        @media print {
            @page { size: A4; margin: 15mm; }
            body { background: white; color: black; -webkit-print-color-adjust: exact; }
            .no-print, header, .tabs-nav { display: none !important; }
            
            /* Hide all views except the modal or the form content */
            #root > div > div.p-6 { display: none; } /* Hides main content area container */
            
            /* Show Modal Content for Print */
            .fixed.inset-0 { 
                position: static !important; 
                background: white !important; 
                display: block !important; 
                height: auto !important; 
                width: 100% !important; 
                overflow: visible !important;
            }
            .fixed.inset-0 > div {
                width: 100% !important;
                max-width: none !important;
                border: none !important;
                box-shadow: none !important;
                background: white !important;
                color: black !important;
            }

            /* Typography */
            h2, h3 { color: black !important; }
            p, span, div { color: black !important; }
            
            /* Tables */
            table { border-collapse: collapse; width: 100%; font-size: 10pt; }
            th, td { border: 1px solid #000 !important; padding: 8px; color: black !important; }
            th { background-color: #f0f0f0 !important; font-weight: bold; }
            
            /* Document Header */
            .doc-header { display: flex !important; justify-content: space-between; border-bottom: 2px solid black; margin-bottom: 20px; padding-bottom: 10px; }
            .section-box { border: 1px solid #000; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
            .bg-slate-800, .bg-slate-900 { background: white !important; }
        }
        
        .doc-header { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div id="root" class="h-full flex flex-col"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get, push, update, set, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { apiKey: "AIzaSyAzfoxuzRbmyrhGChfTEWB05xvyNRmvK3k", authDomain: "ohsms-fa534.firebaseapp.com", databaseURL: "https://ohsms-fa534-default-rtdb.firebaseio.com/", projectId: "ohsms-fa534", storageBucket: "ohsms-fa534.appspot.com", messagingSenderId: "YOUR_SENDER_ID", appId: "YOUR_APP_ID" };
        const app = initializeApp(firebaseConfig);
        window.db = getDatabase(app);
        window.fb = { ref, get, push, update, set, remove };
    </script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const MEETING_TYPES = [
            "Committee Meeting", "Incident Investigation", "Policy Decision", 
            "Objective & Targets", "Legal Aspects", "Continual Improvement Plans", "Program Management"
        ];

        // --- COMPONENT: MEETING DETAIL MODAL (VIEW & PRINT) ---
        const MeetingDetailModal = ({ meeting, onClose, onUpdateStatus, session }) => {
            if (!meeting) return null;

            const printDocument = () => {
                setTimeout(() => window.print(), 500);
            };

            return (
                <div className="fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4 sm:p-6 overflow-y-auto">
                    <div className="bg-slate-900 border border-slate-700 w-full max-w-5xl rounded-2xl flex flex-col shadow-2xl relative min-h-[50vh] animate-fade-in">
                        
                        {/* PRINT HEADER (Visible only in Print) */}
                        <div className="doc-header">
                            <div>
                                <h1 className="text-2xl font-bold uppercase">Minutes of Meeting</h1>
                                <p className="text-sm">Org ID: {session.orgId}</p>
                            </div>
                            <div className="text-right">
                                <p className="text-xl font-mono font-bold">{meeting.id}</p>
                                <p className="text-sm">Date: {meeting.date}</p>
                            </div>
                        </div>

                        {/* Screen Header */}
                        <div className="p-6 border-b border-slate-700 flex justify-between items-start bg-slate-950 rounded-t-2xl no-print">
                            <div>
                                <div className="flex items-center gap-3 mb-2">
                                    <span className="px-2 py-1 rounded bg-blue-500/10 text-blue-400 border border-blue-500/20 text-[10px] font-bold uppercase tracking-wider">{meeting.interaction}</span>
                                    <span className="px-2 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-bold font-mono uppercase tracking-wider">{meeting.id}</span>
                                </div>
                                <h2 className="text-2xl font-bold text-white">{meeting.category}</h2>
                            </div>
                            <div className="flex gap-2">
                                <button onClick={printDocument} className="bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2"><i className="fas fa-file-pdf"></i> Save PDF</button>
                                <button onClick={onClose} className="bg-slate-800 hover:bg-slate-700 text-white w-10 h-10 rounded-lg flex items-center justify-center transition"><i className="fas fa-times"></i></button>
                            </div>
                        </div>

                        <div className="p-8 space-y-8 bg-slate-900 text-black print:bg-white print:text-black">
                            
                            {/* Section 1: Meeting Info */}
                            <div className="section-box print:border-none print:p-0 print:mb-4">
                                <h3 className="text-xs font-bold uppercase text-slate-500 mb-4 print:text-black border-b border-slate-800 pb-2">1. General Information</h3>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-slate-300 print:text-black">
                                    <div><span className="block text-[10px] text-slate-500 uppercase font-bold">Date</span>{meeting.date}</div>
                                    <div><span className="block text-[10px] text-slate-500 uppercase font-bold">Time</span>{meeting.time}</div>
                                    <div><span className="block text-[10px] text-slate-500 uppercase font-bold">Site ID</span>{meeting.siteId}</div>
                                    <div><span className="block text-[10px] text-slate-500 uppercase font-bold">Category</span>{meeting.category}</div>
                                </div>
                            </div>

                            {/* Section 2: Agenda */}
                            <div className="section-box print:border-none print:p-0 print:mb-4">
                                <h3 className="text-xs font-bold uppercase text-slate-500 mb-2 print:text-black border-b border-slate-800 pb-2">2. Agenda</h3>
                                <p className="text-slate-300 text-sm leading-relaxed whitespace-pre-wrap print:text-black">{meeting.agenda}</p>
                            </div>

                            {/* Section 3: Participants */}
                            <div className="section-box print:border-none print:p-0 print:mb-4">
                                <h3 className="text-xs font-bold uppercase text-slate-500 mb-4 print:text-black border-b border-slate-800 pb-2">3. Participants</h3>
                                <table className="w-full text-left text-sm text-slate-300 print:text-black border-collapse">
                                    <thead className="bg-slate-800 text-xs uppercase font-bold text-slate-400 print:bg-gray-100 print:text-black">
                                        <tr><th className="p-3 border-b border-slate-700 print:border-black">Name</th><th className="p-3 border-b border-slate-700 print:border-black">Designation</th><th className="p-3 border-b border-slate-700 print:border-black">Department</th></tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-800 print:divide-black">
                                        {(meeting.participants || []).map((p, i) => (
                                            <tr key={i}>
                                                <td className="p-3 print:border-black font-medium">{p.name}</td>
                                                <td className="p-3 print:border-black">{p.designation}</td>
                                                <td className="p-3 print:border-black">{p.department}</td>
                                            </tr>
                                        ))}
                                        {(!meeting.participants || meeting.participants.length===0) && <tr><td colSpan="3" className="p-3 text-center italic text-slate-500">No participants recorded</td></tr>}
                                    </tbody>
                                </table>
                            </div>

                            {/* Section 4: Action Items */}
                            <div className="section-box print:border-none print:p-0">
                                <h3 className="text-xs font-bold uppercase text-slate-500 mb-4 print:text-black border-b border-slate-800 pb-2">4. Minutes & Action Plan</h3>
                                <table className="w-full text-left text-sm text-slate-300 print:text-black border-collapse">
                                    <thead className="bg-slate-800 text-xs uppercase font-bold text-slate-400 print:bg-gray-100 print:text-black">
                                        <tr>
                                            <th className="p-3 border-b border-slate-700 print:border-black">Point</th>
                                            <th className="p-3 border-b border-slate-700 print:border-black">Action</th>
                                            <th className="p-3 border-b border-slate-700 print:border-black">Responsibility</th>
                                            <th className="p-3 border-b border-slate-700 print:border-black">Target Date</th>
                                            <th className="p-3 border-b border-slate-700 print:border-black w-32">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-800 print:divide-black">
                                        {(meeting.minutes || []).map((row, idx) => (
                                            <tr key={idx}>
                                                <td className="p-3 print:border-black font-medium">{row.point}</td>
                                                <td className="p-3 print:border-black">{row.action}</td>
                                                <td className="p-3 print:border-black">
                                                    <div>{row.owner}</div>
                                                    <div className="text-[10px] text-slate-500 uppercase print:text-black">{row.dept}</div>
                                                </td>
                                                <td className="p-3 print:border-black font-mono text-xs">{row.due}</td>
                                                <td className="p-3 print:border-black">
                                                    {/* Dropdown for Screen, Text for Print */}
                                                    <div className="print:hidden">
                                                        <select 
                                                            value={row.status || 'Open'} 
                                                            onChange={(e) => onUpdateStatus(meeting.id, idx, e.target.value)}
                                                            className={`text-xs font-bold border-none rounded px-2 py-1 cursor-pointer w-full status-${(row.status || 'Open').replace(' ','')}`}
                                                        >
                                                            <option value="Open">Open</option>
                                                            <option value="In Progress">In Progress</option>
                                                            <option value="Closed">Closed</option>
                                                        </select>
                                                    </div>
                                                    <div className="hidden print:block font-bold text-xs uppercase">{row.status}</div>
                                                </td>
                                            </tr>
                                        ))}
                                        {(!meeting.minutes || meeting.minutes.length === 0) && <tr><td colSpan="5" className="p-3 text-center italic text-slate-500">No minutes recorded</td></tr>}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- COMPONENT: MEETING FORM ---
        const MeetingForm = ({ defaultSiteId, session, onSave }) => {
            const [data, setData] = useState({
                id: '', // Will generate dynamically
                siteId: defaultSiteId === 'GLOBAL' ? '' : defaultSiteId, 
                interaction: 'Consultation', 
                category: 'Committee Meeting', 
                date: new Date().toISOString().split('T')[0], 
                time: '', 
                agenda: '',
                minutes: [],
                participants: []
            });

            useEffect(() => {
                // Generate ID: ORG-SITE-C&P-XXXXXX
                const rand = Math.floor(100000 + Math.random() * 900000);
                const sId = data.siteId || 'GEN';
                setData(d => ({ ...d, id: `${session.orgId}-${sId}-C&P-${rand}` }));

                // Handle URL params (from Incident)
                const params = new URLSearchParams(window.location.search);
                if (params.get('agenda')) {
                    setData(prev => ({
                        ...prev,
                        siteId: params.get('site') || prev.siteId,
                        category: params.get('category') || prev.category,
                        date: params.get('date') || prev.date,
                        time: params.get('time') || prev.time,
                        agenda: params.get('agenda') || prev.agenda
                    }));
                }
            }, [data.siteId]);

            // Helpers
            const addRow = () => setData({...data, minutes: [...data.minutes, { point:'', action:'', owner:'', dept:'', due:'', status:'Open' }]});
            const updateRow = (i, f, v) => { const r=[...data.minutes]; r[i][f]=v; setData({...data, minutes:r}); };
            const removeRow = (i) => setData({...data, minutes: data.minutes.filter((_,x)=>x!==i)});
            
            const addPart = () => setData({...data, participants: [...data.participants, { name:'', designation:'', department:'' }]});
            const updatePart = (i, f, v) => { const p=[...data.participants]; p[i][f]=v; setData({...data, participants:p}); };
            const removePart = (i) => setData({...data, participants: data.participants.filter((_,x)=>x!==i)});

            const handleSubmit = () => {
                if(!data.siteId || !data.date || !data.agenda) { alert("Please fill Site ID, Date and Agenda."); return; }
                onSave(data);
            };

            return (
                <div className="animate-fade-in space-y-6 pb-20">
                    {/* ID Badge */}
                    <div className="flex justify-end"><span className="bg-slate-800 text-slate-400 text-xs px-3 py-1 rounded-full font-mono border border-slate-700">ID: {data.id}</span></div>

                    <div className="glass-panel p-6 rounded-2xl">
                        <h3 className="text-blue-400 font-bold mb-4 text-sm border-b border-white/10 pb-2">1. Meeting Details</h3>
                        <div className="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                            <div><label className="text-[10px] text-slate-500 font-bold uppercase">Site ID</label><input value={data.siteId} onChange={e=>setData({...data, siteId:e.target.value})} disabled={defaultSiteId!=='GLOBAL'} className="bg-slate-900 border-blue-500/30" /></div>
                            <div><label className="text-[10px] text-slate-500 font-bold uppercase">Type</label><select value={data.interaction} onChange={e=>setData({...data, interaction:e.target.value})}><option>Consultation</option><option>Participation</option></select></div>
                            <div><label className="text-[10px] text-slate-500 font-bold uppercase">Category</label><select value={data.category} onChange={e=>setData({...data, category:e.target.value})}>{MEETING_TYPES.map(t=><option key={t}>{t}</option>)}</select></div>
                            <div><label className="text-[10px] text-slate-500 font-bold uppercase">Date</label><input type="date" value={data.date} onChange={e=>setData({...data, date:e.target.value})} /></div>
                            <div><label className="text-[10px] text-slate-500 font-bold uppercase">Time</label><input type="time" value={data.time} onChange={e=>setData({...data, time:e.target.value})} /></div>
                        </div>
                        <div><label className="text-[10px] text-slate-500 font-bold uppercase">Agenda</label><textarea rows="2" value={data.agenda} onChange={e=>setData({...data, agenda:e.target.value})}></textarea></div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl">
                        <div className="flex justify-between mb-4 border-b border-white/10 pb-2"><h3 className="text-emerald-400 font-bold text-sm">2. Participants</h3><button onClick={addPart} className="text-[10px] bg-emerald-600 px-2 py-1 rounded text-white">+ Add</button></div>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            {data.participants.map((p,i)=>(
                                <div key={i} className="flex gap-2 bg-slate-800 p-2 rounded border border-slate-700">
                                    <div className="flex-1 space-y-1"><input placeholder="Name" value={p.name} onChange={e=>updatePart(i,'name',e.target.value)} className="text-xs bg-slate-900"/> <input placeholder="Desig" value={p.designation} onChange={e=>updatePart(i,'designation',e.target.value)} className="text-[10px] bg-slate-900"/> <input placeholder="Dept" value={p.department} onChange={e=>updatePart(i,'department',e.target.value)} className="text-[10px] bg-slate-900"/></div>
                                    <button onClick={()=>removePart(i)} className="text-red-400 text-xs self-start">x</button>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl">
                        <div className="flex justify-between mb-4 border-b border-white/10 pb-2"><h3 className="text-purple-400 font-bold text-sm">3. Minutes</h3><button onClick={addRow} className="text-[10px] bg-blue-600 px-2 py-1 rounded text-white">+ Add Point</button></div>
                        {data.minutes.map((r,i)=>(
                            <div key={i} className="grid grid-cols-12 gap-2 mb-2 bg-slate-800/50 p-2 rounded relative group">
                                <div className="col-span-3"><input placeholder="Point" value={r.point} onChange={e=>updateRow(i,'point',e.target.value)} className="text-xs bg-slate-900"/></div>
                                <div className="col-span-3"><input placeholder="Action" value={r.action} onChange={e=>updateRow(i,'action',e.target.value)} className="text-xs bg-slate-900"/></div>
                                <div className="col-span-2"><input placeholder="Owner" value={r.owner} onChange={e=>updateRow(i,'owner',e.target.value)} className="text-xs bg-slate-900"/></div>
                                <div className="col-span-2"><input placeholder="Dept" value={r.dept} onChange={e=>updateRow(i,'dept',e.target.value)} className="text-xs bg-slate-900"/></div>
                                <div className="col-span-2"><input type="date" value={r.due} onChange={e=>updateRow(i,'due',e.target.value)} className="text-xs bg-slate-900"/></div>
                                <button onClick={()=>removeRow(i)} className="absolute -top-1 -right-1 bg-red-500 text-white w-4 h-4 rounded-full text-[10px] opacity-0 group-hover:opacity-100 transition">x</button>
                            </div>
                        ))}
                    </div>

                    <button onClick={handleSubmit} className="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-xl shadow-lg">Save & Generate ID</button>
                </div>
            );
        };

        // --- COMPONENT: LIST ---
        const MeetingList = ({ meetings, onOpenDetail, onDelete, userRole }) => {
            return (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in">
                    {meetings.map(m => (
                        <div key={m.id} className="glass-panel p-5 rounded-2xl border-l-4 border-blue-500 relative group hover:bg-slate-800/50 transition">
                            <div className="flex justify-between mb-2">
                                <span className="text-[10px] uppercase font-bold text-slate-500">{m.interaction}</span>
                                <span className="text-[10px] font-mono text-emerald-400 bg-emerald-900/30 px-2 rounded border border-emerald-900">{m.id}</span>
                            </div>
                            <h3 className="font-bold text-white text-lg mb-1">{m.category}</h3>
                            <div className="text-xs text-slate-400 font-mono mb-4 flex gap-3">
                                <span><i className="fas fa-calendar mr-1"></i>{m.date}</span>
                                <span><i className="fas fa-users mr-1"></i>{m.participants?.length || 0}</span>
                            </div>
                            <div className="flex justify-between items-center mt-4 pt-3 border-t border-slate-700/50">
                                <button onClick={()=>onOpenDetail(m)} className="text-xs bg-blue-600 text-white px-3 py-1.5 rounded hover:bg-blue-500 transition"><i className="fas fa-eye mr-1"></i> View & Print</button>
                                {userRole === 'Owner' && <button onClick={()=>onDelete(m)} className="text-slate-500 hover:text-red-400 transition"><i className="fas fa-trash-alt"></i></button>}
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [view, setView] = useState('form');
            const [session, setSession] = useState(null);
            const [siteId, setSiteId] = useState('GLOBAL');
            const [meetings, setMeetings] = useState([]);
            const [selectedMeeting, setSelectedMeeting] = useState(null);

            useEffect(() => {
                const s = sessionStorage.getItem('isoSession');
                if(!s) { window.location.href = 'index.html'; return; }
                const sess = JSON.parse(s);
                setSession(sess);

                const params = new URLSearchParams(window.location.search);
                const ctx = params.get('site');
                if(ctx && ctx !== 'GLOBAL') setSiteId(ctx);

                window.fb.get(window.fb.ref(window.db, `organizations/${sess.orgId}/consultation`)).then(snap => {
                    if(snap.exists()) {
                        const all = Object.entries(snap.val()).map(([k,v]) => ({firebaseKey:k, ...v}));
                        const filtered = (ctx && ctx !== 'GLOBAL') ? all.filter(m => m.siteId === ctx) : all;
                        setMeetings(filtered);
                    }
                });
            }, []);

            const handleSave = async (data) => {
                await window.fb.push(window.fb.ref(window.db, `organizations/${session.orgId}/consultation`), data);
                // Open modal immediately to allow printing
                setSelectedMeeting(data); 
                alert("Meeting Saved! Click 'Save PDF' in the modal to generate document.");
                // Reload list in background
                window.location.reload();
            };

            const handleDelete = async (m) => {
                if(confirm("Delete this meeting record? This cannot be undone.")) {
                    await window.fb.remove(window.fb.ref(window.db, `organizations/${session.orgId}/consultation/${m.firebaseKey}`));
                    setMeetings(meetings.filter(x => x.firebaseKey !== m.firebaseKey));
                }
            };

            const handleUpdateStatus = async (mid, idx, val) => {
                // Optimistic update
                const updated = meetings.map(m => {
                    if(m.id === mid) {
                        const mins = [...m.minutes];
                        mins[idx].status = val;
                        return {...m, minutes: mins};
                    }
                    return m;
                });
                setMeetings(updated);
                const target = updated.find(m => m.id === mid);
                setSelectedMeeting(target);
                
                // DB Update
                const key = target.firebaseKey;
                await window.fb.update(window.fb.ref(window.db, `organizations/${session.orgId}/consultation/${key}/minutes/${idx}`), { status: val });
            };

            if(!session) return null;

            return (
                <div className="flex flex-col h-screen bg-slate-950 text-white font-sans">
                    {/* Header */}
                    <header className="h-16 border-b border-slate-800 bg-slate-900 flex items-center justify-between px-6 shadow-lg z-10 no-print">
                        <div className="flex items-center gap-4"><a href="home.html" className="text-slate-400 hover:text-white"><i className="fas fa-arrow-left"></i> Back</a><h1 className="font-bold text-lg">Consultation & Participation</h1></div>
                        <div className="text-xs font-mono bg-slate-800 px-3 py-1 rounded text-emerald-400 border border-emerald-900">Context: {siteId}</div>
                    </header>

                    {/* Tabs */}
                    <div className="flex justify-center border-b border-slate-800 bg-slate-900/50 backdrop-blur-sm sticky top-0 z-10 tabs-nav">
                        {['form', 'list', 'dashboard'].map(tab => (
                            <button key={tab} onClick={()=>setView(tab)} className={`px-8 py-3 text-xs font-bold uppercase tracking-wider transition-all border-b-2 ${view===tab ? 'border-blue-500 text-blue-400 bg-blue-500/5' : 'border-transparent text-slate-500 hover:text-white'}`}>
                                {tab === 'form' ? 'Record Meeting' : (tab === 'list' ? 'Meeting History' : 'Analytics')}
                            </button>
                        ))}
                    </div>

                    {/* Content */}
                    <div className="p-6 flex-1 overflow-y-auto max-w-7xl mx-auto w-full">
                        {view === 'form' && <MeetingForm defaultSiteId={siteId} session={session} onSave={handleSave} />}
                        {view === 'list' && <MeetingList meetings={meetings} onOpenDetail={setSelectedMeeting} onDelete={handleDelete} userRole={session.role} />}
                        {view === 'dashboard' && <div className="text-center text-slate-500 mt-20">Dashboard Analytics Coming Soon</div>}
                    </div>

                    {/* Modal */}
                    {selectedMeeting && <MeetingDetailModal meeting={selectedMeeting} onClose={()=>setSelectedMeeting(null)} onUpdateStatus={handleUpdateStatus} session={session} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
